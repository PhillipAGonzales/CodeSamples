## Written by: Phillip A. Gonzales
## Written for: SGS Stephens, INC.
## Allow user to select file for data wrangling 
# Use the following to install via pip
#   python -m pip install --user --trusted-host files.pythonhosted.org --trusted-host pypi.org --trusted-host pypi.python.org <NameOfPackage>

import PySimpleGUI as sg
import sys
from PySimpleGUI.PySimpleGUI import SaveAs
import pandas as pd
import os
import time

def filter_rows_by_values(df, col, values):
        return df[df[col].isin(values) == True]

def Insert_row(row_number, df, row_value):
    # Starting value of upper half
    start_upper = 0
  
    # End value of upper half
    end_upper = row_number
  
    # Start value of lower half
    start_lower = row_number
  
    # End value of lower half
    end_lower = df.shape[0]
  
    # Create a list of upper_half index
    upper_half = [*range(start_upper, end_upper, 1)]
  
    # Create a list of lower_half index
    lower_half = [*range(start_lower, end_lower, 1)]
  
    # Increment the value of lower half by 1
    lower_half = [x.__add__(1) for x in lower_half]
  
    # Combine the two lists
    index_ = upper_half + lower_half
  
    # Update the index of the dataframe
    df.index = index_
  
    # Insert a row at the end
    df.loc[row_number] = row_value
   
    # Sort the index labels
    df = df.sort_index()
  
    # return the dataframe
    return df

goodReadings = ["00:00:00",
                "00:00:01",
                "00:00:02",
                "00:00:03",
                "00:00:04",
                "00:00:05",
                "00:00:06",
                "00:00:07",
                "00:00:08",
                "00:00:09",
                "00:00:10",
                "00:00:11",
                "00:00:12",
                "00:00:13",
                "00:00:14",
                "00:00:15",
                "00:00:16",
                "00:00:17",
                "00:00:18",
                "00:00:19",
                "00:00:20",
                "00:00:21",
                "00:00:22",
                "00:00:23",
                "00:00:24",
                "00:00:25",
                "00:00:26",
                "00:00:27",
                "00:00:28",
                "00:00:29",
                "00:00:30",
                "00:00:31",
                "00:00:32",
                "00:00:33",
                "00:00:34",
                "00:00:35",
                "00:00:36",
                "00:00:37",
                "00:00:38",
                "00:00:39",
                "00:00:40",
                "00:00:41",
                "00:00:42",
                "00:00:43",
                "00:00:44",
                "00:00:45",
                "00:00:46",
                "00:00:47",
                "00:00:48",
                "00:00:49",
                "00:00:50",
                "00:00:51",
                "00:00:52",
                "00:00:53",
                "00:00:54",
                "00:00:55",
                "00:00:56",
                "00:00:57",
                "00:00:58",
                "00:00:59",
                "01:00:00",
                "01:00:01",
                "01:00:02",
                "01:00:03",
                "01:00:04",
                "01:00:05",
                "01:00:06",
                "01:00:07",
                "01:00:08",
                "01:00:09",
                "01:00:10",
                "01:00:11",
                "01:00:12",
                "01:00:13",
                "01:00:14",
                "01:00:15",
                "01:00:16",
                "01:00:17",
                "01:00:18",
                "01:00:19",
                "01:00:20",
                "01:00:21",
                "01:00:22",
                "01:00:23",
                "01:00:24",
                "01:00:25",
                "01:00:26",
                "01:00:27",
                "01:00:28",
                "01:00:29",
                "01:00:30",
                "01:00:31",
                "01:00:32",
                "01:00:33",
                "01:00:34",
                "01:00:35",
                "01:00:36",
                "01:00:37",
                "01:00:38",
                "01:00:39",
                "01:00:40",
                "01:00:41",
                "01:00:42",
                "01:00:43",
                "01:00:44",
                "01:00:45",
                "01:00:46",
                "01:00:47",
                "01:00:48",
                "01:00:49",
                "01:00:50",
                "01:00:51",
                "01:00:52",
                "01:00:53",
                "01:00:54",
                "01:00:55",
                "01:00:56",
                "01:00:57",
                "01:00:58",
                "01:00:59",
                "02:00:00",
                "02:00:01",
                "02:00:02",
                "02:00:03",
                "02:00:04",
                "02:00:05",
                "02:00:06",
                "02:00:07",
                "02:00:08",
                "02:00:09",
                "02:00:10",
                "02:00:11",
                "02:00:12",
                "02:00:13",
                "02:00:14",
                "02:00:15",
                "02:00:16",
                "02:00:17",
                "02:00:18",
                "02:00:19",
                "02:00:20",
                "02:00:21",
                "02:00:22",
                "02:00:23",
                "02:00:24",
                "02:00:25",
                "02:00:26",
                "02:00:27",
                "02:00:28",
                "02:00:29",
                "02:00:30",
                "02:00:31",
                "02:00:32",
                "02:00:33",
                "02:00:34",
                "02:00:35",
                "02:00:36",
                "02:00:37",
                "02:00:38",
                "02:00:39",
                "02:00:40",
                "02:00:41",
                "02:00:42",
                "02:00:43",
                "02:00:44",
                "02:00:45",
                "02:00:46",
                "02:00:47",
                "02:00:48",
                "02:00:49",
                "02:00:50",
                "02:00:51",
                "02:00:52",
                "02:00:53",
                "02:00:54",
                "02:00:55",
                "02:00:56",
                "02:00:57",
                "02:00:58",
                "02:00:59",
                "03:00:00",
                "03:00:01",
                "03:00:02",
                "03:00:03",
                "03:00:04",
                "03:00:05",
                "03:00:06",
                "03:00:07",
                "03:00:08",
                "03:00:09",
                "03:00:10",
                "03:00:11",
                "03:00:12",
                "03:00:13",
                "03:00:14",
                "03:00:15",
                "03:00:16",
                "03:00:17",
                "03:00:18",
                "03:00:19",
                "03:00:20",
                "03:00:21",
                "03:00:22",
                "03:00:23",
                "03:00:24",
                "03:00:25",
                "03:00:26",
                "03:00:27",
                "03:00:28",
                "03:00:29",
                "03:00:30",
                "03:00:31",
                "03:00:32",
                "03:00:33",
                "03:00:34",
                "03:00:35",
                "03:00:36",
                "03:00:37",
                "03:00:38",
                "03:00:39",
                "03:00:40",
                "03:00:41",
                "03:00:42",
                "03:00:43",
                "03:00:44",
                "03:00:45",
                "03:00:46",
                "03:00:47",
                "03:00:48",
                "03:00:49",
                "03:00:50",
                "03:00:51",
                "03:00:52",
                "03:00:53",
                "03:00:54",
                "03:00:55",
                "03:00:56",
                "03:00:57",
                "03:00:58",
                "03:00:59",
                "04:00:00",
                "04:00:01",
                "04:00:02",
                "04:00:03",
                "04:00:04",
                "04:00:05",
                "04:00:06",
                "04:00:07",
                "04:00:08",
                "04:00:09",
                "04:00:10",
                "04:00:11",
                "04:00:12",
                "04:00:13",
                "04:00:14",
                "04:00:15",
                "04:00:16",
                "04:00:17",
                "04:00:18",
                "04:00:19",
                "04:00:20",
                "04:00:21",
                "04:00:22",
                "04:00:23",
                "04:00:24",
                "04:00:25",
                "04:00:26",
                "04:00:27",
                "04:00:28",
                "04:00:29",
                "04:00:30",
                "04:00:31",
                "04:00:32",
                "04:00:33",
                "04:00:34",
                "04:00:35",
                "04:00:36",
                "04:00:37",
                "04:00:38",
                "04:00:39",
                "04:00:40",
                "04:00:41",
                "04:00:42",
                "04:00:43",
                "04:00:44",
                "04:00:45",
                "04:00:46",
                "04:00:47",
                "04:00:48",
                "04:00:49",
                "04:00:50",
                "04:00:51",
                "04:00:52",
                "04:00:53",
                "04:00:54",
                "04:00:55",
                "04:00:56",
                "04:00:57",
                "04:00:58",
                "04:00:59",
                "05:00:00",
                "05:00:01",
                "05:00:02",
                "05:00:03",
                "05:00:04",
                "05:00:05",
                "05:00:06",
                "05:00:07",
                "05:00:08",
                "05:00:09",
                "05:00:10",
                "05:00:11",
                "05:00:12",
                "05:00:13",
                "05:00:14",
                "05:00:15",
                "05:00:16",
                "05:00:17",
                "05:00:18",
                "05:00:19",
                "05:00:20",
                "05:00:21",
                "05:00:22",
                "05:00:23",
                "05:00:24",
                "05:00:25",
                "05:00:26",
                "05:00:27",
                "05:00:28",
                "05:00:29",
                "05:00:30",
                "05:00:31",
                "05:00:32",
                "05:00:33",
                "05:00:34",
                "05:00:35",
                "05:00:36",
                "05:00:37",
                "05:00:38",
                "05:00:39",
                "05:00:40",
                "05:00:41",
                "05:00:42",
                "05:00:43",
                "05:00:44",
                "05:00:45",
                "05:00:46",
                "05:00:47",
                "05:00:48",
                "05:00:49",
                "05:00:50",
                "05:00:51",
                "05:00:52",
                "05:00:53",
                "05:00:54",
                "05:00:55",
                "05:00:56",
                "05:00:57",
                "05:00:58",
                "05:00:59",
                "06:00:00",
                "06:00:01",
                "06:00:02",
                "06:00:03",
                "06:00:04",
                "06:00:05",
                "06:00:06",
                "06:00:07",
                "06:00:08",
                "06:00:09",
                "06:00:10",
                "06:00:11",
                "06:00:12",
                "06:00:13",
                "06:00:14",
                "06:00:15",
                "06:00:16",
                "06:00:17",
                "06:00:18",
                "06:00:19",
                "06:00:20",
                "06:00:21",
                "06:00:22",
                "06:00:23",
                "06:00:24",
                "06:00:25",
                "06:00:26",
                "06:00:27",
                "06:00:28",
                "06:00:29",
                "06:00:30",
                "06:00:31",
                "06:00:32",
                "06:00:33",
                "06:00:34",
                "06:00:35",
                "06:00:36",
                "06:00:37",
                "06:00:38",
                "06:00:39",
                "06:00:40",
                "06:00:41",
                "06:00:42",
                "06:00:43",
                "06:00:44",
                "06:00:45",
                "06:00:46",
                "06:00:47",
                "06:00:48",
                "06:00:49",
                "06:00:50",
                "06:00:51",
                "06:00:52",
                "06:00:53",
                "06:00:54",
                "06:00:55",
                "06:00:56",
                "06:00:57",
                "06:00:58",
                "06:00:59",
                "07:00:00",
                "07:00:01",
                "07:00:02",
                "07:00:03",
                "07:00:04",
                "07:00:05",
                "07:00:06",
                "07:00:07",
                "07:00:08",
                "07:00:09",
                "07:00:10",
                "07:00:11",
                "07:00:12",
                "07:00:13",
                "07:00:14",
                "07:00:15",
                "07:00:16",
                "07:00:17",
                "07:00:18",
                "07:00:19",
                "07:00:20",
                "07:00:21",
                "07:00:22",
                "07:00:23",
                "07:00:24",
                "07:00:25",
                "07:00:26",
                "07:00:27",
                "07:00:28",
                "07:00:29",
                "07:00:30",
                "07:00:31",
                "07:00:32",
                "07:00:33",
                "07:00:34",
                "07:00:35",
                "07:00:36",
                "07:00:37",
                "07:00:38",
                "07:00:39",
                "07:00:40",
                "07:00:41",
                "07:00:42",
                "07:00:43",
                "07:00:44",
                "07:00:45",
                "07:00:46",
                "07:00:47",
                "07:00:48",
                "07:00:49",
                "07:00:50",
                "07:00:51",
                "07:00:52",
                "07:00:53",
                "07:00:54",
                "07:00:55",
                "07:00:56",
                "07:00:57",
                "07:00:58",
                "07:00:59",
                "08:00:00",
                "08:00:01",
                "08:00:02",
                "08:00:03",
                "08:00:04",
                "08:00:05",
                "08:00:06",
                "08:00:07",
                "08:00:08",
                "08:00:09",
                "08:00:10",
                "08:00:11",
                "08:00:12",
                "08:00:13",
                "08:00:14",
                "08:00:15",
                "08:00:16",
                "08:00:17",
                "08:00:18",
                "08:00:19",
                "08:00:20",
                "08:00:21",
                "08:00:22",
                "08:00:23",
                "08:00:24",
                "08:00:25",
                "08:00:26",
                "08:00:27",
                "08:00:28",
                "08:00:29",
                "08:00:30",
                "08:00:31",
                "08:00:32",
                "08:00:33",
                "08:00:34",
                "08:00:35",
                "08:00:36",
                "08:00:37",
                "08:00:38",
                "08:00:39",
                "08:00:40",
                "08:00:41",
                "08:00:42",
                "08:00:43",
                "08:00:44",
                "08:00:45",
                "08:00:46",
                "08:00:47",
                "08:00:48",
                "08:00:49",
                "08:00:50",
                "08:00:51",
                "08:00:52",
                "08:00:53",
                "08:00:54",
                "08:00:55",
                "08:00:56",
                "08:00:57",
                "08:00:58",
                "08:00:59",
                "09:00:00",
                "09:00:01",
                "09:00:02",
                "09:00:03",
                "09:00:04",
                "09:00:05",
                "09:00:06",
                "09:00:07",
                "09:00:08",
                "09:00:09",
                "09:00:10",
                "09:00:11",
                "09:00:12",
                "09:00:13",
                "09:00:14",
                "09:00:15",
                "09:00:16",
                "09:00:17",
                "09:00:18",
                "09:00:19",
                "09:00:20",
                "09:00:21",
                "09:00:22",
                "09:00:23",
                "09:00:24",
                "09:00:25",
                "09:00:26",
                "09:00:27",
                "09:00:28",
                "09:00:29",
                "09:00:30",
                "09:00:31",
                "09:00:32",
                "09:00:33",
                "09:00:34",
                "09:00:35",
                "09:00:36",
                "09:00:37",
                "09:00:38",
                "09:00:39",
                "09:00:40",
                "09:00:41",
                "09:00:42",
                "09:00:43",
                "09:00:44",
                "09:00:45",
                "09:00:46",
                "09:00:47",
                "09:00:48",
                "09:00:49",
                "09:00:50",
                "09:00:51",
                "09:00:52",
                "09:00:53",
                "09:00:54",
                "09:00:55",
                "09:00:56",
                "09:00:57",
                "09:00:58",
                "09:00:59",
                "10:00:00",
                "10:00:01",
                "10:00:02",
                "10:00:03",
                "10:00:04",
                "10:00:05",
                "10:00:06",
                "10:00:07",
                "10:00:08",
                "10:00:09",
                "10:00:10",
                "10:00:11",
                "10:00:12",
                "10:00:13",
                "10:00:14",
                "10:00:15",
                "10:00:16",
                "10:00:17",
                "10:00:18",
                "10:00:19",
                "10:00:20",
                "10:00:21",
                "10:00:22",
                "10:00:23",
                "10:00:24",
                "10:00:25",
                "10:00:26",
                "10:00:27",
                "10:00:28",
                "10:00:29",
                "10:00:30",
                "10:00:31",
                "10:00:32",
                "10:00:33",
                "10:00:34",
                "10:00:35",
                "10:00:36",
                "10:00:37",
                "10:00:38",
                "10:00:39",
                "10:00:40",
                "10:00:41",
                "10:00:42",
                "10:00:43",
                "10:00:44",
                "10:00:45",
                "10:00:46",
                "10:00:47",
                "10:00:48",
                "10:00:49",
                "10:00:50",
                "10:00:51",
                "10:00:52",
                "10:00:53",
                "10:00:54",
                "10:00:55",
                "10:00:56",
                "10:00:57",
                "10:00:58",
                "10:00:59",
                "11:00:00",
                "11:00:01",
                "11:00:02",
                "11:00:03",
                "11:00:04",
                "11:00:05",
                "11:00:06",
                "11:00:07",
                "11:00:08",
                "11:00:09",
                "11:00:10",
                "11:00:11",
                "11:00:12",
                "11:00:13",
                "11:00:14",
                "11:00:15",
                "11:00:16",
                "11:00:17",
                "11:00:18",
                "11:00:19",
                "11:00:20",
                "11:00:21",
                "11:00:22",
                "11:00:23",
                "11:00:24",
                "11:00:25",
                "11:00:26",
                "11:00:27",
                "11:00:28",
                "11:00:29",
                "11:00:30",
                "11:00:31",
                "11:00:32",
                "11:00:33",
                "11:00:34",
                "11:00:35",
                "11:00:36",
                "11:00:37",
                "11:00:38",
                "11:00:39",
                "11:00:40",
                "11:00:41",
                "11:00:42",
                "11:00:43",
                "11:00:44",
                "11:00:45",
                "11:00:46",
                "11:00:47",
                "11:00:48",
                "11:00:49",
                "11:00:50",
                "11:00:51",
                "11:00:52",
                "11:00:53",
                "11:00:54",
                "11:00:55",
                "11:00:56",
                "11:00:57",
                "11:00:58",
                "11:00:59",
                "12:00:00",
                "12:00:01",
                "12:00:02",
                "12:00:03",
                "12:00:04",
                "12:00:05",
                "12:00:06",
                "12:00:07",
                "12:00:08",
                "12:00:09",
                "12:00:10",
                "12:00:11",
                "12:00:12",
                "12:00:13",
                "12:00:14",
                "12:00:15",
                "12:00:16",
                "12:00:17",
                "12:00:18",
                "12:00:19",
                "12:00:20",
                "12:00:21",
                "12:00:22",
                "12:00:23",
                "12:00:24",
                "12:00:25",
                "12:00:26",
                "12:00:27",
                "12:00:28",
                "12:00:29",
                "12:00:30",
                "12:00:31",
                "12:00:32",
                "12:00:33",
                "12:00:34",
                "12:00:35",
                "12:00:36",
                "12:00:37",
                "12:00:38",
                "12:00:39",
                "12:00:40",
                "12:00:41",
                "12:00:42",
                "12:00:43",
                "12:00:44",
                "12:00:45",
                "12:00:46",
                "12:00:47",
                "12:00:48",
                "12:00:49",
                "12:00:50",
                "12:00:51",
                "12:00:52",
                "12:00:53",
                "12:00:54",
                "12:00:55",
                "12:00:56",
                "12:00:57",
                "12:00:58",
                "12:00:59",
                "13:00:00",
                "13:00:01",
                "13:00:02",
                "13:00:03",
                "13:00:04",
                "13:00:05",
                "13:00:06",
                "13:00:07",
                "13:00:08",
                "13:00:09",
                "13:00:10",
                "13:00:11",
                "13:00:12",
                "13:00:13",
                "13:00:14",
                "13:00:15",
                "13:00:16",
                "13:00:17",
                "13:00:18",
                "13:00:19",
                "13:00:20",
                "13:00:21",
                "13:00:22",
                "13:00:23",
                "13:00:24",
                "13:00:25",
                "13:00:26",
                "13:00:27",
                "13:00:28",
                "13:00:29",
                "13:00:30",
                "13:00:31",
                "13:00:32",
                "13:00:33",
                "13:00:34",
                "13:00:35",
                "13:00:36",
                "13:00:37",
                "13:00:38",
                "13:00:39",
                "13:00:40",
                "13:00:41",
                "13:00:42",
                "13:00:43",
                "13:00:44",
                "13:00:45",
                "13:00:46",
                "13:00:47",
                "13:00:48",
                "13:00:49",
                "13:00:50",
                "13:00:51",
                "13:00:52",
                "13:00:53",
                "13:00:54",
                "13:00:55",
                "13:00:56",
                "13:00:57",
                "13:00:58",
                "13:00:59",
                "14:00:00",
                "14:00:01",
                "14:00:02",
                "14:00:03",
                "14:00:04",
                "14:00:05",
                "14:00:06",
                "14:00:07",
                "14:00:08",
                "14:00:09",
                "14:00:10",
                "14:00:11",
                "14:00:12",
                "14:00:13",
                "14:00:14",
                "14:00:15",
                "14:00:16",
                "14:00:17",
                "14:00:18",
                "14:00:19",
                "14:00:20",
                "14:00:21",
                "14:00:22",
                "14:00:23",
                "14:00:24",
                "14:00:25",
                "14:00:26",
                "14:00:27",
                "14:00:28",
                "14:00:29",
                "14:00:30",
                "14:00:31",
                "14:00:32",
                "14:00:33",
                "14:00:34",
                "14:00:35",
                "14:00:36",
                "14:00:37",
                "14:00:38",
                "14:00:39",
                "14:00:40",
                "14:00:41",
                "14:00:42",
                "14:00:43",
                "14:00:44",
                "14:00:45",
                "14:00:46",
                "14:00:47",
                "14:00:48",
                "14:00:49",
                "14:00:50",
                "14:00:51",
                "14:00:52",
                "14:00:53",
                "14:00:54",
                "14:00:55",
                "14:00:56",
                "14:00:57",
                "14:00:58",
                "14:00:59",
                "15:00:00",
                "15:00:01",
                "15:00:02",
                "15:00:03",
                "15:00:04",
                "15:00:05",
                "15:00:06",
                "15:00:07",
                "15:00:08",
                "15:00:09",
                "15:00:10",
                "15:00:11",
                "15:00:12",
                "15:00:13",
                "15:00:14",
                "15:00:15",
                "15:00:16",
                "15:00:17",
                "15:00:18",
                "15:00:19",
                "15:00:20",
                "15:00:21",
                "15:00:22",
                "15:00:23",
                "15:00:24",
                "15:00:25",
                "15:00:26",
                "15:00:27",
                "15:00:28",
                "15:00:29",
                "15:00:30",
                "15:00:31",
                "15:00:32",
                "15:00:33",
                "15:00:34",
                "15:00:35",
                "15:00:36",
                "15:00:37",
                "15:00:38",
                "15:00:39",
                "15:00:40",
                "15:00:41",
                "15:00:42",
                "15:00:43",
                "15:00:44",
                "15:00:45",
                "15:00:46",
                "15:00:47",
                "15:00:48",
                "15:00:49",
                "15:00:50",
                "15:00:51",
                "15:00:52",
                "15:00:53",
                "15:00:54",
                "15:00:55",
                "15:00:56",
                "15:00:57",
                "15:00:58",
                "15:00:59",
                "16:00:00",
                "16:00:01",
                "16:00:02",
                "16:00:03",
                "16:00:04",
                "16:00:05",
                "16:00:06",
                "16:00:07",
                "16:00:08",
                "16:00:09",
                "16:00:10",
                "16:00:11",
                "16:00:12",
                "16:00:13",
                "16:00:14",
                "16:00:15",
                "16:00:16",
                "16:00:17",
                "16:00:18",
                "16:00:19",
                "16:00:20",
                "16:00:21",
                "16:00:22",
                "16:00:23",
                "16:00:24",
                "16:00:25",
                "16:00:26",
                "16:00:27",
                "16:00:28",
                "16:00:29",
                "16:00:30",
                "16:00:31",
                "16:00:32",
                "16:00:33",
                "16:00:34",
                "16:00:35",
                "16:00:36",
                "16:00:37",
                "16:00:38",
                "16:00:39",
                "16:00:40",
                "16:00:41",
                "16:00:42",
                "16:00:43",
                "16:00:44",
                "16:00:45",
                "16:00:46",
                "16:00:47",
                "16:00:48",
                "16:00:49",
                "16:00:50",
                "16:00:51",
                "16:00:52",
                "16:00:53",
                "16:00:54",
                "16:00:55",
                "16:00:56",
                "16:00:57",
                "16:00:58",
                "16:00:59",
                "17:00:00",
                "17:00:01",
                "17:00:02",
                "17:00:03",
                "17:00:04",
                "17:00:05",
                "17:00:06",
                "17:00:07",
                "17:00:08",
                "17:00:09",
                "17:00:10",
                "17:00:11",
                "17:00:12",
                "17:00:13",
                "17:00:14",
                "17:00:15",
                "17:00:16",
                "17:00:17",
                "17:00:18",
                "17:00:19",
                "17:00:20",
                "17:00:21",
                "17:00:22",
                "17:00:23",
                "17:00:24",
                "17:00:25",
                "17:00:26",
                "17:00:27",
                "17:00:28",
                "17:00:29",
                "17:00:30",
                "17:00:31",
                "17:00:32",
                "17:00:33",
                "17:00:34",
                "17:00:35",
                "17:00:36",
                "17:00:37",
                "17:00:38",
                "17:00:39",
                "17:00:40",
                "17:00:41",
                "17:00:42",
                "17:00:43",
                "17:00:44",
                "17:00:45",
                "17:00:46",
                "17:00:47",
                "17:00:48",
                "17:00:49",
                "17:00:50",
                "17:00:51",
                "17:00:52",
                "17:00:53",
                "17:00:54",
                "17:00:55",
                "17:00:56",
                "17:00:57",
                "17:00:58",
                "17:00:59",
                "18:00:00",
                "18:00:01",
                "18:00:02",
                "18:00:03",
                "18:00:04",
                "18:00:05",
                "18:00:06",
                "18:00:07",
                "18:00:08",
                "18:00:09",
                "18:00:10",
                "18:00:11",
                "18:00:12",
                "18:00:13",
                "18:00:14",
                "18:00:15",
                "18:00:16",
                "18:00:17",
                "18:00:18",
                "18:00:19",
                "18:00:20",
                "18:00:21",
                "18:00:22",
                "18:00:23",
                "18:00:24",
                "18:00:25",
                "18:00:26",
                "18:00:27",
                "18:00:28",
                "18:00:29",
                "18:00:30",
                "18:00:31",
                "18:00:32",
                "18:00:33",
                "18:00:34",
                "18:00:35",
                "18:00:36",
                "18:00:37",
                "18:00:38",
                "18:00:39",
                "18:00:40",
                "18:00:41",
                "18:00:42",
                "18:00:43",
                "18:00:44",
                "18:00:45",
                "18:00:46",
                "18:00:47",
                "18:00:48",
                "18:00:49",
                "18:00:50",
                "18:00:51",
                "18:00:52",
                "18:00:53",
                "18:00:54",
                "18:00:55",
                "18:00:56",
                "18:00:57",
                "18:00:58",
                "18:00:59",
                "19:00:00",
                "19:00:01",
                "19:00:02",
                "19:00:03",
                "19:00:04",
                "19:00:05",
                "19:00:06",
                "19:00:07",
                "19:00:08",
                "19:00:09",
                "19:00:10",
                "19:00:11",
                "19:00:12",
                "19:00:13",
                "19:00:14",
                "19:00:15",
                "19:00:16",
                "19:00:17",
                "19:00:18",
                "19:00:19",
                "19:00:20",
                "19:00:21",
                "19:00:22",
                "19:00:23",
                "19:00:24",
                "19:00:25",
                "19:00:26",
                "19:00:27",
                "19:00:28",
                "19:00:29",
                "19:00:30",
                "19:00:31",
                "19:00:32",
                "19:00:33",
                "19:00:34",
                "19:00:35",
                "19:00:36",
                "19:00:37",
                "19:00:38",
                "19:00:39",
                "19:00:40",
                "19:00:41",
                "19:00:42",
                "19:00:43",
                "19:00:44",
                "19:00:45",
                "19:00:46",
                "19:00:47",
                "19:00:48",
                "19:00:49",
                "19:00:50",
                "19:00:51",
                "19:00:52",
                "19:00:53",
                "19:00:54",
                "19:00:55",
                "19:00:56",
                "19:00:57",
                "19:00:58",
                "19:00:59",
                "20:00:00",
                "20:00:01",
                "20:00:02",
                "20:00:03",
                "20:00:04",
                "20:00:05",
                "20:00:06",
                "20:00:07",
                "20:00:08",
                "20:00:09",
                "20:00:10",
                "20:00:11",
                "20:00:12",
                "20:00:13",
                "20:00:14",
                "20:00:15",
                "20:00:16",
                "20:00:17",
                "20:00:18",
                "20:00:19",
                "20:00:20",
                "20:00:21",
                "20:00:22",
                "20:00:23",
                "20:00:24",
                "20:00:25",
                "20:00:26",
                "20:00:27",
                "20:00:28",
                "20:00:29",
                "20:00:30",
                "20:00:31",
                "20:00:32",
                "20:00:33",
                "20:00:34",
                "20:00:35",
                "20:00:36",
                "20:00:37",
                "20:00:38",
                "20:00:39",
                "20:00:40",
                "20:00:41",
                "20:00:42",
                "20:00:43",
                "20:00:44",
                "20:00:45",
                "20:00:46",
                "20:00:47",
                "20:00:48",
                "20:00:49",
                "20:00:50",
                "20:00:51",
                "20:00:52",
                "20:00:53",
                "20:00:54",
                "20:00:55",
                "20:00:56",
                "20:00:57",
                "20:00:58",
                "20:00:59",
                "21:00:00",
                "21:00:01",
                "21:00:02",
                "21:00:03",
                "21:00:04",
                "21:00:05",
                "21:00:06",
                "21:00:07",
                "21:00:08",
                "21:00:09",
                "21:00:10",
                "21:00:11",
                "21:00:12",
                "21:00:13",
                "21:00:14",
                "21:00:15",
                "21:00:16",
                "21:00:17",
                "21:00:18",
                "21:00:19",
                "21:00:20",
                "21:00:21",
                "21:00:22",
                "21:00:23",
                "21:00:24",
                "21:00:25",
                "21:00:26",
                "21:00:27",
                "21:00:28",
                "21:00:29",
                "21:00:30",
                "21:00:31",
                "21:00:32",
                "21:00:33",
                "21:00:34",
                "21:00:35",
                "21:00:36",
                "21:00:37",
                "21:00:38",
                "21:00:39",
                "21:00:40",
                "21:00:41",
                "21:00:42",
                "21:00:43",
                "21:00:44",
                "21:00:45",
                "21:00:46",
                "21:00:47",
                "21:00:48",
                "21:00:49",
                "21:00:50",
                "21:00:51",
                "21:00:52",
                "21:00:53",
                "21:00:54",
                "21:00:55",
                "21:00:56",
                "21:00:57",
                "21:00:58",
                "21:00:59",
                "22:00:00",
                "22:00:01",
                "22:00:02",
                "22:00:03",
                "22:00:04",
                "22:00:05",
                "22:00:06",
                "22:00:07",
                "22:00:08",
                "22:00:09",
                "22:00:10",
                "22:00:11",
                "22:00:12",
                "22:00:13",
                "22:00:14",
                "22:00:15",
                "22:00:16",
                "22:00:17",
                "22:00:18",
                "22:00:19",
                "22:00:20",
                "22:00:21",
                "22:00:22",
                "22:00:23",
                "22:00:24",
                "22:00:25",
                "22:00:26",
                "22:00:27",
                "22:00:28",
                "22:00:29",
                "22:00:30",
                "22:00:31",
                "22:00:32",
                "22:00:33",
                "22:00:34",
                "22:00:35",
                "22:00:36",
                "22:00:37",
                "22:00:38",
                "22:00:39",
                "22:00:40",
                "22:00:41",
                "22:00:42",
                "22:00:43",
                "22:00:44",
                "22:00:45",
                "22:00:46",
                "22:00:47",
                "22:00:48",
                "22:00:49",
                "22:00:50",
                "22:00:51",
                "22:00:52",
                "22:00:53",
                "22:00:54",
                "22:00:55",
                "22:00:56",
                "22:00:57",
                "22:00:58",
                "22:00:59",
                "23:00:00",
                "23:00:01",
                "23:00:02",
                "23:00:03",
                "23:00:04",
                "23:00:05",
                "23:00:06",
                "23:00:07",
                "23:00:08",
                "23:00:09",
                "23:00:10",
                "23:00:11",
                "23:00:12",
                "23:00:13",
                "23:00:14",
                "23:00:15",
                "23:00:16",
                "23:00:17",
                "23:00:18",
                "23:00:19",
                "23:00:20",
                "23:00:21",
                "23:00:22",
                "23:00:23",
                "23:00:24",
                "23:00:25",
                "23:00:26",
                "23:00:27",
                "23:00:28",
                "23:00:29",
                "23:00:30",
                "23:00:31",
                "23:00:32",
                "23:00:33",
                "23:00:34",
                "23:00:35",
                "23:00:36",
                "23:00:37",
                "23:00:38",
                "23:00:39",
                "23:00:40",
                "23:00:41",
                "23:00:42",
                "23:00:43",
                "23:00:44",
                "23:00:45",
                "23:00:46",
                "23:00:47",
                "23:00:48",
                "23:00:49",
                "23:00:50",
                "23:00:51",
                "23:00:52",
                "23:00:53",
                "23:00:54",
                "23:00:55",
                "23:00:56",
                "23:00:57",
                "23:00:58",
                "23:00:59"]

def CleanTheCSV():
    fname = sg.popup_get_file('Document to open ex. datalog_data(#)',
                               keep_on_top=True,
                               title='Sensaphone Data Cleaner!',
                               grab_anywhere=True,
                               history = True,
                               initial_folder= ''.join(('C:/Users/', os.getlogin(),'/Downloads/')))
    if fname == None:
        sg.popup("Cancelling: No file supplied")
        window.close() 
    else:
        ## Back-end
        progBar = [0,1,2,3,4,5,6,7,8,9,10,11,12]
        progMax = len(progBar)
        sg.one_line_progress_meter('Cleaning...',progBar[0], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        rawDF = pd.read_csv(fname,names= ('Date/Time','Location','Reading','Status'))
        rawDF.loc[0, 'Date/Time':] = rawDF.loc[0, 'Date/Time':].shift()
        rawDF.loc[1, 'Date/Time':] = rawDF.loc[1, 'Date/Time':].shift()
        formattedDF = rawDF['Date/Time'].str.split(' ',expand = True)
        formattedDF.rename(columns ={0:"Date",1:"Time",2:"Time-Zone"}, inplace = True)
        formattedDF.insert(loc = 3, column='Location',value = rawDF['Location'])
        formattedDF.insert(loc = 4, column='Reading',value = rawDF['Reading'])
        topRows = formattedDF[0:2]
        filteredDF = filter_rows_by_values(formattedDF,"Time",goodReadings)
        sg.one_line_progress_meter('Cleaning...',progBar[1], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)

        sensorLocation = filteredDF.iloc[4]['Location']
        parenthesis = '('
        hyphen = '-'
        if parenthesis in sensorLocation:
            sensorLocation = filteredDF.iloc[4]['Location']
            firstSplit = sensorLocation.split('(')
            secondSplit = firstSplit[1].split(')')
            uID = secondSplit[0]
            sg.one_line_progress_meter('Cleaning...',progBar[2], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        elif hyphen in sensorLocation:
            nameSplit1 = sensorLocation.split('- ',1)
            nameSplit2 = nameSplit1[1].split(' ')
            uID = nameSplit2[0] + ' ' + nameSplit2[1]
            sg.one_line_progress_meter('Cleaning...',progBar[2], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)

        sg.one_line_progress_meter('Cleaning...',progBar[3], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        processedDF = pd.concat([topRows,filteredDF])
        endDate = processedDF.iloc[2]['Date']
        startDate = processedDF.iloc[len(processedDF)-1]['Date']
        sg.one_line_progress_meter('Cleaning...',progBar[4], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        strEndDate = endDate.replace("/",".")
        strStartDate = startDate.replace("/",".")
        processedDF['Reading']= pd.to_numeric(processedDF['Reading'],errors='coerce')
        multiZoneCheck1 = processedDF.iloc[2]['Location']
        multiZoneCheck2 = processedDF.iloc[3]['Location']

        sg.one_line_progress_meter('Cleaning...',progBar[5], progMax)
        if multiZoneCheck1 == multiZoneCheck2:
            maxReading = max(processedDF['Reading'][2:]) 
            minReading = min(processedDF['Reading'][2:]) 
            statsZoneSeries = pd.Series([' ',
                                         ' ',
                                         "{}:".format(multiZoneCheck1)])
            statsValueSeries = pd.Series([' ',
                                          ' ',
                                         "Max = {}".format(maxReading),
                                         "Min = {}".format(minReading)])
            generatedFileName = "{}".format(uID) + " " + strStartDate + "-" + strEndDate
            sg.one_line_progress_meter('Cleaning...',progBar[6], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        else:
            zone1Rows = processedDF.loc[processedDF['Location'] == multiZoneCheck1]
            zone1Readings = zone1Rows['Reading']
            zone1Max = max(zone1Readings)
            zone1Min = min(zone1Readings)
            zone2Rows = processedDF.loc[processedDF['Location'] == multiZoneCheck2]
            zone2Readings = zone2Rows['Reading']
            zone2Max = max(zone2Readings)
            zone2Min = min(zone2Readings)
            statsZoneSeries = pd.Series([' ',
                                         ' ',
                                         "{}:".format(multiZoneCheck1),
                                         ' ',
                                         ' ',
                                         "{}:".format(multiZoneCheck2)])
            statsValueSeries = pd.Series([' ',
                                          ' ',
                                         "Max = {}".format(zone1Max),
                                         "Min = {}".format(zone1Min),
                                         ' ',
                                         "Max = {}".format(zone2Max),
                                         "Min = {}".format(zone2Min)])
            sg.one_line_progress_meter('Cleaning...',progBar[6], progMax)
            rH = 'Humidity'
            temperature = 'Temperature'
            if (((rH in multiZoneCheck1) and (temperature in multiZoneCheck2)) or ((rH in multiZoneCheck2) and (temperature in multiZoneCheck1))):
                generatedFileName = "{}".format(uID) + " RH & Temp " + strStartDate + "-" + strEndDate   
                sg.one_line_progress_meter('Cleaning...',progBar[7], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
            else:                    
                generatedFileName = "{}".format(uID) + " Temps " + strStartDate + "-" + strEndDate
                sg.one_line_progress_meter('Cleaning...',progBar[7], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        
        sg.one_line_progress_meter('Cleaning...',progBar[8], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        processedDF.insert(loc = 5, column=' ',value = ' ')
        processedDF.reset_index(inplace = True, drop = True)
        processedDF.insert(loc = 6, column='Stats-Zone',value = statsZoneSeries)
        processedDF.insert(loc = 7, column='Stats-Values',value = statsValueSeries)
        processedDF.fillna(' ',inplace=True)
        processedDF.set_index('Date', inplace = True)
        sg.one_line_progress_meter('Cleaning...',progBar[9], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        saveLocation = sg.popup_get_folder('Select file save location',
                                            title='Save Here',
                                            grab_anywhere = True,
                                            keep_on_top = True,
                                            history = True, 
                                            initial_folder= 'G:\Clinic\Chart Recorders')
        sg.one_line_progress_meter('Cleaning...',progBar[10], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        generatedFileName = '{}.xlsx'.format(generatedFileName)
        saveAsPath = os.path.join(saveLocation)
        saveAsGeneratedFileName = saveAsPath + '/' + generatedFileName
        processedDF.to_excel(saveAsGeneratedFileName)
        sg.one_line_progress_meter('Cleaning...',progBar[11], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        time.sleep(0.5)
        fileName = fname.split('/')
        readableFileName = fileName[len(fileName)-1]
        sg.one_line_progress_meter('Cleaning...',progBar[12], progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        time.sleep(0.5)
        sg.one_line_progress_meter('Cleaning...',progMax    , progMax, orientation = 'h',grab_anywhere = True, keep_on_top= True, no_button = True)
        sg.popup('File Processing COMPLETE!\nInput file name: {oldFileName}\nNew file name: {newFileName}'.format(oldFileName = readableFileName,newFileName = generatedFileName),
                  title= 'File Cleaned & Formatted!',
                  grab_anywhere = True,
                  keep_on_top = True)

sg.theme('DarkGrey8')

layout = [[sg.Text('Click start to begin'),sg.Text(size=(20,1), key='-FileName-')],
          [sg.Button('Start!')]]

window = sg.Window('Sesaphone Data Cleaner',layout,keep_on_top=True)

while True:
    event, values = window.read()
    print(event, values)
    if event == sg.WIN_CLOSED:
        break
    if event == 'Start!':
        CleanTheCSV()

window.close()